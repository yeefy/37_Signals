define("libs/statsd",["require","exports","module","jquery"],function(e,t,n){var r=e("jquery"),i="/stats/v1/batch",s=function(e){e=e||{},this.FLUSH_INTERVAL=(e.flushInterval||10)*1e3,this.QUEUE_LIMIT=e.queueLimit||10,this.flushUrl=e.flushUrl,this._statsdQueue=[],this._flushTimeout=null,e.stopped||this._startIntervalFlush(),this._registerBeforeUnload()};(function(){this._preparedData=function(){return{data:this._statsdQueue}},this._flush=function(){r.ajax({type:"POST",url:this.flushUrl,data:JSON.stringify(this._preparedData()),contentType:"application/json"}),this._statsdQueue=[]},this._flushIfNecessary=function(){this._statsdQueue.length>0&&this._flush()},this._record=function(e,t,n,r){var i={name:e,payload:{measurement:t,action:n}};r!=null&&(i.payload.value=r),this._statsdQueue.push(i),setTimeout(this._flushIfOverflow.bind(this),0)},this._flushIfOverflow=function(){if(this._statsdQueue.length>=this.QUEUE_LIMIT){var e=!1;this._flushTimeout!==null&&(this._stopIntervalFlush(),e=!0),this._flush(),e&&this._startIntervalFlush()}},this._stopIntervalFlush=function(){clearTimeout(this._flushTimeout),this._flushTimeout=null},this._startIntervalFlush=function(){this._flushIfNecessary(),this._flushTimeout=setTimeout(this._startIntervalFlush.bind(this),this.FLUSH_INTERVAL)},this._registerBeforeUnload=function(){r(window).on("beforeunload",this._flushIfNecessary.bind(this))},this.increment=function(e,t){this._record(e,t,"increment",null)},this.decrement=function(e,t){this._record(e,t,"decrement",null)},this.gauge=function(e,t,n){this._record(e,t,"gauge",n)},this.timing=function(e,t,n){this._record(e,t,"timing",n)},this.set=function(e,t,n){this._record(e,t,"set",n)}}).call(s.prototype),n.exports=new s({flushUrl:i})}),define("controllers/registrations_controller",["require","exports","module","libs/utils","jquery","libs/statsd"],function(e,t){var n=e("libs/utils"),r=e("jquery"),i=e("libs/statsd");t.init=function(){var e=n.deparam(window.location.href).email;e&&r("#user_email").val(e),document.URL.indexOf("register/sign_up")>-1?r("#registration_birthday").length>0?_gaq.push(["_setCustomVar",3,"with_dob","Yes",2]):_gaq.push(["_setCustomVar",3,"with_dob","No",2]):r(".sign_up").click(function(){r("#registration_birthday").length>0?_gaq.push(["_setCustomVar",3,"with_dob","Yes",2]):_gaq.push(["_setCustomVar",3,"with_dob","No",2])}),r(document).on("submit","#new-user",function(e){e.preventDefault();var t=r(this).find('select[name="birthday[year]"]').val(),n=r(this).find('select[name="birthday[month]"]').val(),s=r(this).find('select[name="birthday[day]"]').val();if(t&&n&&s){var o=new Date(n+"/"+s+"/"+t);if(new Date-o<4103136e5){i.increment("registration","underThirteen.count"),r(this).html('<div id="error_explanation">Signup failed</div>');return}}r(document).off("submit","#new-user"),r(this).find('input[name="user[email]"]').length>0&&r(this).submit()})}})
;
